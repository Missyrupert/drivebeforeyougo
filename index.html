<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#ffffff">
  <title>DriveBeforeYouGo — Rehearse Your Drive</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="icon" href="/favicon.png" type="image/png">
  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon" href="/icons/icon-192.png">
</head>
<body>
  <div id="app">

    <!-- SCREEN 1: Journey Input -->
    <section id="input-screen" class="screen active">
      <header class="app-header">
        <h1>DriveBeforeYouGo</h1>
        <p class="tagline">Rehearse tricky junctions before you drive</p>
      </header>

      <section class="landing">
        <h2>Rehearse the hard parts of a drive — before you drive</h2>
        <p class="landing-subhead">
          DriveBeforeYouGo helps you prepare for complex junctions and awkward lane choices using simple Street View rehearsals.
        </p>

        <div class="landing-section">
          <h3>Problem</h3>
          <p>Some drives aren't hard — they're just unfamiliar.</p>
          <p>It's not the distance that causes stress. It's the roundabout you've never seen before. The exit where you need to be in the right lane early. The junction where everyone else seems to know what to do.</p>
          <p>That uncertainty can turn a normal drive into something you dread.</p>
        </div>

        <div class="landing-section">
          <h3>Solution</h3>
          <p>DriveBeforeYouGo lets you rehearse those moments in advance.</p>
          <p>You enter a start and destination, like a satnav. Instead of showing the whole route, the app focuses only on the tricky decision points — especially roundabouts and lane changes.</p>
          <p>Using Street View imagery, you can slowly step through each junction and see: which lane you need, what the road actually looks like, where the decision happens.</p>
          <p>No pressure. No traffic. No surprises.</p>
        </div>

        <div class="landing-section">
          <button type="button" id="landing-cta" class="btn-primary landing-cta">Try a rehearsal</button>
        </div>

        <div class="landing-section">
          <h3>What it’s for / isn’t</h3>
          <p>This isn’t a driving lesson. It doesn’t tell you how to drive.</p>
          <p>It simply removes the unknowns, so when you get there for real, it already feels familiar.</p>
        </div>

        <div class="landing-section">
          <h3>When it helps most</h3>
          <ul class="landing-list">
            <li>Driving somewhere new</li>
            <li>Returning to driving after a bad experience</li>
            <li>Routes with confusing junctions or roundabouts</li>
            <li>Any drive you’re already thinking about too much</li>
          </ul>
        </div>

        <p class="landing-close">Sometimes confidence comes from practice. Sometimes it just comes from seeing things once before they matter.</p>
      </section>

      <form id="journey-form" autocomplete="off">
        <div class="input-group">
          <label>Start</label>
          <div id="origin-container" class="autocomplete-container"></div>
        </div>

        <div class="swap-btn-wrap">
          <button type="button" id="swap-btn" aria-label="Swap start and destination">&#8645;</button>
        </div>

        <div class="input-group">
          <label>Destination</label>
          <div id="dest-container" class="autocomplete-container"></div>
        </div>

        <button type="submit" id="find-btn" class="btn-primary">
          Find Tricky Junctions
        </button>
      </form>

      <div id="input-error" class="error-msg" hidden></div>
    </section>

    <!-- SCREEN 2: Loading / Analysis -->
    <section id="loading-screen" class="screen">
      <div class="loader-wrap">
        <div class="loader-spinner"></div>
        <p id="loading-msg">Planning your route...</p>
      </div>
    </section>

    <!-- SCREEN 3: Rehearsal Player -->
    <section id="player-screen" class="screen">
      <header class="player-header">
        <button id="back-btn" class="btn-icon" aria-label="Back to search">&larr;</button>
        <div class="route-summary">
          <span id="route-summary-text"></span>
        </div>
      </header>

      <!-- Junction list / overview -->
      <div id="junction-overview">
        <div class="junction-count">
          <span id="junction-total">0</span> tricky junctions found
        </div>
        <div class="roundabout-count">
          <span id="roundabout-total">0</span> roundabouts (primary)
        </div>
        <div id="junction-list" class="junction-list"></div>
        <div id="debug-panel" class="debug-panel" hidden></div>
        <button id="start-rehearsal-btn" class="btn-primary">
          Start Rehearsal
        </button>
      </div>

      <!-- Street View player -->
      <div id="rehearsal-view" hidden>
        <div id="streetview-container">
          <canvas id="annotation-canvas"></canvas>
        </div>
        <div id="orientation-overlay" class="orientation-overlay" hidden>
          <div class="orientation-car"></div>
          <div class="orientation-arrow"></div>
        </div>

        <div id="annotation-toolbar" class="annotation-toolbar" hidden>
          <div class="toolbar-tools">
            <button class="tool-btn" data-tool="arrow" title="Add Arrow">Arrow</button>
            <button class="tool-btn" data-tool="text" title="Add Text">Text</button>
            <button class="tool-btn" data-tool="highlight" title="Add Highlight">Highlight</button>
          </div>
          <div class="toolbar-options">
            <label>Colour: <input type="color" id="anno-colour" value="#ff3333"></label>
            <label>Size: <select id="anno-size">
              <option value="small">S</option>
              <option value="medium" selected>M</option>
              <option value="large">L</option>
            </select></label>
          </div>
          <div class="toolbar-actions">
            <button id="anno-clear-btn" class="btn-toolbar">Clear</button>
            <button id="anno-save-btn" class="btn-toolbar btn-toolbar-primary">Save</button>
            <button id="anno-cancel-btn" class="btn-toolbar">Cancel</button>
          </div>
        </div>

        <div class="junction-info-overlay">
          <div class="junction-badge" id="junction-badge">1 / 5</div>
          <p id="junction-description"></p>
          <span class="junction-type-tag" id="junction-type-tag"></span>
          <span class="decision-label" id="decision-label" hidden>Decision point</span>
          <button id="annotate-btn" class="btn-annotate" title="Annotate this junction">Annotate</button>
        </div>

        <div class="player-controls">
          <button id="prev-btn" class="btn-control" aria-label="Previous junction">&#9664;&#9664;</button>
          <button id="play-pause-btn" class="btn-control btn-play" aria-label="Play/Pause">&#9654;</button>
          <button id="next-btn" class="btn-control" aria-label="Next junction">&#9654;&#9654;</button>
        </div>

        <div class="speed-controls">
          <label>Speed:</label>
          <button class="speed-btn" data-speed="0.5">Slow</button>
          <button class="speed-btn active" data-speed="1">Normal</button>
          <button class="speed-btn" data-speed="2">Fast</button>
          <button class="speed-btn" data-speed="0">Skip</button>
        </div>

        <div class="progress-bar-wrap">
          <div class="progress-bar" id="progress-bar"></div>
        </div>
      </div>
    </section>

  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
  <script src="/js/route-analyzer.js"></script>
  <script src="/js/rehearsal-player.js"></script>
  <script src="/js/annotation-editor.js"></script>
  <script src="/js/app.js"></script>
  <!-- Google Maps loaded by app.js with user's API key -->
</body>
</html>
